var fabric=fabric||{};fabric.Breadcrumb=function(e){this.breadcrumb=e,this.breadcrumbList=e.querySelector(".ms-Breadcrumb-list"),this.listItems=e.querySelectorAll(".ms-Breadcrumb-listItem"),this.contextMenu=e.querySelector(".ms-ContextualMenu"),this.overflowButton=e.querySelector(".ms-Breadcrumb-overflowButton"),this.overflowMenu=e.querySelector(".ms-Breadcrumb-overflowMenu"),this.itemCollection=[],this.currentMaxItems=0,this.init()},fabric.Breadcrumb.prototype=function(){var e=639,t=function(){p.call(this),a.call(this),o.call(this,null)},i=function(e,t,i){this.itemCollection.push({text:e,link:t,tabIndex:i}),g.call(this)},n=function(e){for(var t=this.itemCollection.length;t--;)this.itemCollection[t].text===e&&this.itemCollection.splice(t,1);g.call(this)},s=function(e){this.itemCollection.splice(e,1),g.call(this)},a=function(){var e,t,i,n,s=this.listItems.length,a=0;for(a;s>a;a++)e=this.listItems[a].querySelector(".ms-Breadcrumb-itemLink"),t=e.textContent,i=e.getAttribute("href"),n=parseInt(e.getAttribute("tabindex"),10),this.itemCollection.push({text:t,link:i,tabIndex:n})},o=function(){h.call(this,null),r.call(this)},r=function(){var t=window.innerWidth>e?4:2;t!==this.currentMaxItems&&g.call(this),this.currentMaxItems=t},l=function(e){d.call(this,this.contextMenu);var t=this.itemCollection.length-e,i=this.itemCollection.slice(0,t),n=this.contextMenu;i.forEach(function(e){var t=document.createElement("li");t.className="ms-ContextualMenu-item",isNaN(e.tabIndex)||t.setAttribute("tabindex",e.tabIndex);var i=document.createElement("a");i.className="ms-ContextualMenu-link",null!==e.link&&i.setAttribute("href",e.link),i.textContent=e.text,t.appendChild(i),n.appendChild(t)})},c=function(e){d.call(this,this.breadcrumbList);var t=this.itemCollection.length-e;if(t=0>t?0:t,t>=0)for(t;t<this.itemCollection.length;t++){var i=document.createElement("li"),n=this.itemCollection[t],s=document.createElement("a"),a=document.createElement("i");i.className="ms-Breadcrumb-listItem",s.className="ms-Breadcrumb-itemLink",null!==n.link&&s.setAttribute("href",n.link),isNaN(n.tabIndex)||s.setAttribute("tabindex",n.tabIndex),s.textContent=n.text,a.className="ms-Breadcrumb-chevron ms-Icon ms-Icon--chevronRight",i.appendChild(s),i.appendChild(a),this.breadcrumbList.appendChild(i)}},d=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},m=function(e){-1===this.overflowMenu.className.indexOf(" is-open")&&(this.overflowMenu.className+=" is-open",v.call(this,e),this.overflowButton.focus())},u=function(e){13===e.keyCode&&m.call(this,e)},h=function(e){e&&e.target===this.overflowButton||f.call(this,this.overflowMenu," is-open")},f=function(e,t){var i=e.className.indexOf(t);i>-1&&(e.className=e.className.substring(0,i))},p=function(){window.addEventListener("resize",o.bind(this),!1),document.addEventListener("click",h.bind(this),!1),this.overflowButton.addEventListener("click",m.bind(this),!1),this.overflowButton.addEventListener("keypress",u.bind(this),!1),this.breadcrumbList.addEventListener("click",v.bind(this),!1)},v=function(e){e.target.blur()},g=function(){var t=window.innerWidth>e?4:2;this.itemCollection.length>t?this.breadcrumb.className+=" is-overflow":f.call(this,this.breadcrumb," is-overflow"),c.call(this,t),l.call(this,t)};return{init:t,addItem:i,removeItemByLabel:n,removeItemByPosition:s}}(),function(e){e.fn.CommandBar=function(){var t=function(e){var t='<li class="ms-ContextualMenu-item"><a class="ms-ContextualMenu-link"" href="#">';return t+=e,t+="</a></li>"},i=function(t,i,n){var s=[];return t.each(function(){var t=e(this),a=t.position().left+t.outerWidth()+i+10-n.position().left;s.push({jquery:t,rightOffset:a})}),s},n=function(e,t,i){for(var n=[],s=0;s<e.length;s++){var a=e[s].jquery,o=e[s].rightOffset;a.hasClass("ms-CommandBarItem-overflow")||(o+i>t?n.push(a):a.removeClass("is-hidden"))}return n},s=function(i,n,s){var a="";if(i.length>0){n.addClass("is-visible"),s.html("");for(var o=0;o<i.length;o++){var r=e(i[o]);r.addClass("is-hidden");var l=r.find(".ms-CommandBarItem-commandText").text();a+=t(l)}s.html(a)}else n.removeClass("is-visible")};return this.each(function(){var t,a,o=e(this),r=o.find(".ms-CommandBar-mainArea"),l=r.find(".ms-CommandBarItem").not(".ms-CommandBarItem-overflow"),c=o.find(".ms-CommandBarItem-overflow"),d=o.find(".ms-CommandBarItem-overflow").outerWidth(),m=o.find(".ms-CommandBar-overflowMenu"),u=o.find(".ms-CommandBarSearch"),h=!1;a=i(l,d,r),t=n(a,r.innerWidth(),d),s(t,c,m),e(window).width()<640&&e(".ms-CommandBarSearch-iconSearchWrapper").click(function(){e(this).closest(".ms-CommandBarSearch").addClass("is-active")}),e(window).resize(function(){var t;e(window).width()<640&&h===!1?(a=i(l,d,r),h=!0,e(".ms-CommandBarSearch-iconSearchWrapper").unbind(),e(".ms-CommandBarSearch-iconSearchWrapper").click(function(){e(this).closest(".ms-CommandBarSearch").addClass("is-active")})):e(window).width()>639&&h===!0&&(a=i(l,d,r),h=!1,e(".ms-CommandBarSearch").unbind()),t=n(a,r.innerWidth(),d),s(t,c,m)}),c.click(function(){m.toggleClass("is-open")}),c.focusout(function(){m.removeClass("is-open")}),u.find(".ms-CommandBarSearch-input").click(function(){e(this).closest(".ms-CommandBarSearch").addClass("is-active")}),u.find(".ms-CommandBarSearch-input").on("focus",function(){e(this).closest(".ms-CommandBarSearch").addClass("is-active")}),u.find(".ms-CommandBarSearch-iconClearWrapper").click(function(){var t=e(this).parent().find(".ms-CommandBarSearch-input");t.val(""),t.parent().removeClass("is-active")}),u.parent().find(".ms-CommandBarSearch-input").blur(function(){var t=e(this);t.val(""),t.parent().removeClass("is-active")})})}}(jQuery),function(e){function t(t){var s=t.find(".ms-DatePicker-monthComponents"),a=t.find(".ms-DatePicker-goToday"),o=t.find(".ms-DatePicker-monthPicker"),r=t.find(".ms-DatePicker-yearPicker"),l=t.find(".ms-DatePicker-wrap"),c=t.find(".ms-TextField-field").pickadate("picker");s.appendTo(l),a.appendTo(l),o.appendTo(l),r.appendTo(l),n(t),s.on("click",".js-prevMonth",function(e){e.preventDefault();var t=c.get("highlight").month-1;i(c,null,t,null)}),s.on("click",".js-nextMonth",function(e){e.preventDefault();var t=c.get("highlight").month+1;i(c,null,t,null)}),o.on("click",".js-prevYear",function(e){e.preventDefault();var t=c.get("highlight").year-1;i(c,t,null,null)}),o.on("click",".js-nextYear",function(e){e.preventDefault();var t=c.get("highlight").year+1;i(c,t,null,null)}),r.on("click",".js-prevDecade",function(e){e.preventDefault();var t=c.get("highlight").year-10;i(c,t,null,null)}),r.on("click",".js-nextDecade",function(e){e.preventDefault();var t=c.get("highlight").year+10;i(c,t,null,null)}),a.click(function(e){e.preventDefault();var i=new Date;c.set("select",[i.getFullYear(),i.getMonth(),i.getDate()]),t.removeClass("is-pickingMonths").removeClass("is-pickingYears")}),o.on("click",".js-changeDate",function(n){n.preventDefault();var s=e(this).attr("data-year"),a=e(this).attr("data-month"),o=e(this).attr("data-day");i(c,s,a,o),t.hasClass("is-pickingMonths")&&t.removeClass("is-pickingMonths")}),r.on("click",".js-changeDate",function(n){n.preventDefault();var s=e(this).attr("data-year"),a=e(this).attr("data-month"),o=e(this).attr("data-day");i(c,s,a,o),t.hasClass("is-pickingYears")&&t.removeClass("is-pickingYears")}),o.on("click",".js-showDayPicker",function(){t.removeClass("is-pickingMonths"),t.removeClass("is-pickingYears")}),s.on("click",".js-showMonthPicker",function(){t.toggleClass("is-pickingMonths")}),o.on("click",".js-showYearPicker",function(){t.toggleClass("is-pickingYears")})}function i(e,t,i,n){"undefined"!=typeof t&&null!==t||(t=e.get("highlight").year),"undefined"!=typeof i&&null!==i||(i=e.get("highlight").month),"undefined"!=typeof n&&null!==n||(n=e.get("highlight").date),e.set("highlight",[t,i,n])}function n(e){var t=e.find(".ms-DatePicker-monthPicker"),i=e.find(".ms-DatePicker-yearPicker"),n=e.find(".ms-TextField-field").pickadate("picker");t.find(".ms-DatePicker-currentYear").text(n.get("view").year),t.find(".ms-DatePicker-monthOption").removeClass("is-highlighted"),t.find('.ms-DatePicker-monthOption[data-month="'+n.get("highlight").month+'"]').addClass("is-highlighted"),i.find(".ms-DatePicker-currentDecade").remove(),i.find(".ms-DatePicker-optionGrid").remove();var s=n.get("highlight").year-11,a=s+" - "+(s+11),o='<div class="ms-DatePicker-currentDecade">'+a+"</div>";o+='<div class="ms-DatePicker-optionGrid">';for(var r=s;s+12>r;r++)o+='<span class="ms-DatePicker-yearOption js-changeDate" data-year="'+r+'">'+r+"</span>";o+="</div>",i.append(o),i.find(".ms-DatePicker-yearOption").removeClass("is-highlighted"),i.find('.ms-DatePicker-yearOption[data-year="'+n.get("highlight").year+'"]').addClass("is-highlighted")}function s(t){e("html, body").animate({scrollTop:t.offset().top},367)}e.fn.DatePicker=function(i){return this.each(function(){var a=e(this),o=a.find(".ms-TextField-field").pickadate(e.extend({weekdaysShort:["S","M","T","W","T","F","S"],today:"",clear:"",close:"",onStart:function(){t(a)},klass:{input:"ms-DatePicker-input",active:"ms-DatePicker-input--active",picker:"ms-DatePicker-picker",opened:"ms-DatePicker-picker--opened",focused:"ms-DatePicker-picker--focused",holder:"ms-DatePicker-holder",frame:"ms-DatePicker-frame",wrap:"ms-DatePicker-wrap",box:"ms-DatePicker-dayPicker",header:"ms-DatePicker-header",month:"ms-DatePicker-month",year:"ms-DatePicker-year",table:"ms-DatePicker-table",weekdays:"ms-DatePicker-weekday",day:"ms-DatePicker-day",disabled:"ms-DatePicker-day--disabled",selected:"ms-DatePicker-day--selected",highlighted:"ms-DatePicker-day--highlighted",now:"ms-DatePicker-day--today",infocus:"ms-DatePicker-day--infocus",outfocus:"ms-DatePicker-day--outfocus"}},i||{})),r=o.pickadate("picker");r.on({render:function(){n(a)},open:function(){s(a)}})})}}(jQuery),!function(e){"function"==typeof define&&define.amd?define("picker",["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):this.Picker=e(jQuery)}(function(e){function t(a,o,r,d){function m(){return t._.node("div",t._.node("div",t._.node("div",t._.node("div",b.component.nodes(g.open),P.box),P.wrap),P.frame),P.holder)}function u(){y.data(o,b).addClass(P.input).val(y.data("value")?b.get("select",k.format):a.value).on("focus."+g.id+" click."+g.id,p),k.editable||y.on("keydown."+g.id,function(e){var t=e.keyCode,i=/^(8|46)$/.test(t);return 27==t?(b.close(),!1):void((32==t||i||!g.open&&b.component.key[t])&&(e.preventDefault(),e.stopPropagation(),i?b.clear().close():b.open()))}),s(a,{haspopup:!0,expanded:!1,readonly:!1,owns:a.id+"_root"+(b._hidden?" "+b._hidden.id:"")})}function h(){b.$root.on({focusin:function(e){b.$root.removeClass(P.focused),e.stopPropagation()},"mousedown click":function(t){var i=t.target;i!=b.$root.children()[0]&&(t.stopPropagation(),"mousedown"!=t.type||e(i).is(":input")||"OPTION"==i.nodeName||(t.preventDefault(),a.focus()))}}).on("click","[data-pick], [data-nav], [data-clear], [data-close]",function(){var t=e(this),i=t.data(),n=t.hasClass(P.navDisabled)||t.hasClass(P.disabled),s=document.activeElement;s=s&&(s.type||s.href)&&s,(n||s&&!e.contains(b.$root[0],s))&&a.focus(),!n&&i.nav?b.set("highlight",b.component.item.highlight,{nav:i.nav}):!n&&"pick"in i?b.set("select",i.pick).close(!0):i.clear?b.clear().close(!0):i.close&&b.close(!0)}),s(b.$root[0],"hidden",!0)}function f(){var t;k.hiddenName===!0?(t=a.name,a.name=""):(t=["string"==typeof k.hiddenPrefix?k.hiddenPrefix:"","string"==typeof k.hiddenSuffix?k.hiddenSuffix:"_submit"],t=t[0]+a.name+t[1]),b._hidden=e('<input type=hidden name="'+t+'"'+(y.data("value")||a.value?' value="'+b.get("select",k.formatSubmit)+'"':"")+">")[0],y.on("change."+g.id,function(){b._hidden.value=a.value?b.get("select",k.formatSubmit):""}).after(b._hidden)}function p(e){e.stopPropagation(),"focus"==e.type&&b.$root.addClass(P.focused),b.open()}if(!a)return t;var v=!1,g={id:a.id||"P"+Math.abs(~~(Math.random()*new Date))},k=r?e.extend(!0,{},r.defaults,d):d||{},P=e.extend({},t.klasses(),k.klass),y=e(a),C=function(){return this.start()},b=C.prototype={constructor:C,$node:y,start:function(){return g&&g.start?b:(g.methods={},g.start=!0,g.open=!1,g.type=a.type,a.autofocus=a==document.activeElement,a.readOnly=!k.editable,a.id=a.id||g.id,"text"!=a.type&&(a.type="text"),b.component=new r(b,k),b.$root=e(t._.node("div",m(),P.picker,'id="'+a.id+'_root"')),h(),k.formatSubmit&&f(),u(),k.container?e(k.container).append(b.$root):y.after(b.$root),b.on({start:b.component.onStart,render:b.component.onRender,stop:b.component.onStop,open:b.component.onOpen,close:b.component.onClose,set:b.component.onSet}).on({start:k.onStart,render:k.onRender,stop:k.onStop,open:k.onOpen,close:k.onClose,set:k.onSet}),v=i(b.$root.children()[0]),a.autofocus&&b.open(),b.trigger("start").trigger("render"))},render:function(e){return e?b.$root.html(m()):b.$root.find("."+P.box).html(b.component.nodes(g.open)),b.trigger("render")},stop:function(){return g.start?(b.close(),b._hidden&&b._hidden.parentNode.removeChild(b._hidden),b.$root.remove(),y.removeClass(P.input).removeData(o),setTimeout(function(){y.off("."+g.id)},0),a.type=g.type,a.readOnly=!1,b.trigger("stop"),g.methods={},g.start=!1,b):b},open:function(i){return g.open?b:(y.addClass(P.active),s(a,"expanded",!0),setTimeout(function(){b.$root.addClass(P.opened),s(b.$root[0],"hidden",!1)},0),i!==!1&&(g.open=!0,v&&c.css("overflow","hidden").css("padding-right","+="+n()),y.trigger("focus"),l.on("click."+g.id+" focusin."+g.id,function(e){var t=e.target;t!=a&&t!=document&&3!=e.which&&b.close(t===b.$root.children()[0])}).on("keydown."+g.id,function(i){var n=i.keyCode,s=b.component.key[n],o=i.target;27==n?b.close(!0):o!=a||!s&&13!=n?e.contains(b.$root[0],o)&&13==n&&(i.preventDefault(),o.click()):(i.preventDefault(),s?t._.trigger(b.component.key.go,b,[t._.trigger(s)]):b.$root.find("."+P.highlighted).hasClass(P.disabled)||b.set("select",b.component.item.highlight).close())})),b.trigger("open"))},close:function(e){return e&&(y.off("focus."+g.id).trigger("focus"),setTimeout(function(){y.on("focus."+g.id,p)},0)),y.removeClass(P.active),s(a,"expanded",!1),setTimeout(function(){b.$root.removeClass(P.opened+" "+P.focused),s(b.$root[0],"hidden",!0)},0),g.open?(g.open=!1,v&&c.css("overflow","").css("padding-right","-="+n()),l.off("."+g.id),b.trigger("close")):b},clear:function(e){return b.set("clear",null,e)},set:function(t,i,n){var s,a,o=e.isPlainObject(t),r=o?t:{};if(n=o&&e.isPlainObject(i)?i:n||{},t){o||(r[t]=i);for(s in r)a=r[s],s in b.component.item&&(void 0===a&&(a=null),b.component.set(s,a,n)),("select"==s||"clear"==s)&&y.val("clear"==s?"":b.get(s,k.format)).trigger("change");b.render()}return n.muted?b:b.trigger("set",r)},get:function(e,i){if(e=e||"value",null!=g[e])return g[e];if("value"==e)return a.value;if(e in b.component.item){if("string"==typeof i){var n=b.component.get(e);return n?t._.trigger(b.component.formats.toString,b.component,[i,n]):""}return b.component.get(e)}},on:function(t,i,n){var s,a,o=e.isPlainObject(t),r=o?t:{};if(t){o||(r[t]=i);for(s in r)a=r[s],n&&(s="_"+s),g.methods[s]=g.methods[s]||[],g.methods[s].push(a)}return b},off:function(){var e,t,i=arguments;for(e=0,namesCount=i.length;namesCount>e;e+=1)t=i[e],t in g.methods&&delete g.methods[t];return b},trigger:function(e,i){var n=function(e){var n=g.methods[e];n&&n.map(function(e){t._.trigger(e,b,[i])})};return n("_"+e),n(e),b}};return new C}function i(e){var t,i="position";return e.currentStyle?t=e.currentStyle[i]:window.getComputedStyle&&(t=getComputedStyle(e)[i]),"fixed"==t}function n(){if(c.height()<=r.height())return 0;var t=e('<div style="visibility:hidden;width:100px" />').appendTo("body"),i=t[0].offsetWidth;t.css("overflow","scroll");var n=e('<div style="width:100%" />').appendTo(t),s=n[0].offsetWidth;return t.remove(),i-s}function s(t,i,n){if(e.isPlainObject(i))for(var s in i)a(t,s,i[s]);else a(t,i,n)}function a(e,t,i){e.setAttribute(("role"==t?"":"aria-")+t,i)}function o(t,i){e.isPlainObject(t)||(t={attribute:i}),i="";for(var n in t){var s=("role"==n?"":"aria-")+n,a=t[n];i+=null==a?"":s+'="'+t[n]+'"'}return i}var r=e(window),l=e(document),c=e(document.documentElement);return t.klasses=function(e){return e=e||"picker",{picker:e,opened:e+"--opened",focused:e+"--focused",input:e+"__input",active:e+"__input--active",holder:e+"__holder",frame:e+"__frame",wrap:e+"__wrap",box:e+"__box"}},t._={group:function(e){for(var i,n="",s=t._.trigger(e.min,e);s<=t._.trigger(e.max,e,[s]);s+=e.i)i=t._.trigger(e.item,e,[s]),n+=t._.node(e.node,i[0],i[1],i[2]);return n},node:function(t,i,n,s){return i?(i=e.isArray(i)?i.join(""):i,n=n?' class="'+n+'"':"",s=s?" "+s:"","<"+t+n+s+">"+i+"</"+t+">"):""},lead:function(e){return(10>e?"0":"")+e},trigger:function(e,t,i){return"function"==typeof e?e.apply(t,i||[]):e},digits:function(e){return/\d/.test(e[1])?2:1},isDate:function(e){return{}.toString.call(e).indexOf("Date")>-1&&this.isInteger(e.getUTCDate())},isInteger:function(e){return{}.toString.call(e).indexOf("Number")>-1&&e%1===0},ariaAttr:o},t.extend=function(i,n){e.fn[i]=function(s,a){var o=this.data(i);return"picker"==s?o:o&&"string"==typeof s?t._.trigger(o[s],o,[a]):this.each(function(){var a=e(this);a.data(i)||new t(this,i,n,s)})},e.fn[i].defaults=n.defaults},t}),function(e){"function"==typeof define&&define.amd?define(["picker","jquery"],e):"object"==typeof exports?module.exports=e(require("./picker.js"),require("jquery")):e(Picker,jQuery)}(function(e,t){function i(e,t){var i=this,n=e.$node[0],s=n.value,a=e.$node.data("value"),o=a||s,r=a?t.formatSubmit:t.format,l=function(){return n.currentStyle?"rtl"==n.currentStyle.direction:"rtl"==getComputedStyle(e.$root[0]).direction};i.settings=t,i.$node=e.$node,i.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse navigate create validate",view:"parse create validate viewset",disable:"deactivate",enable:"activate"},i.item={},i.item.clear=null,i.item.disable=(t.disable||[]).slice(0),i.item.enable=-function(e){return e[0]===!0?e.shift():-1}(i.item.disable),i.set("min",t.min).set("max",t.max).set("now"),o?i.set("select",o,{format:r}):i.set("select",null).set("highlight",i.item.now),i.key={40:7,38:-7,39:function(){return l()?-1:1},37:function(){return l()?1:-1},go:function(e){var t=i.item.highlight,n=new Date(Date.UTC(t.year,t.month,t.date+e));i.set("highlight",n,{interval:e}),this.render()}},e.on("render",function(){e.$root.find("."+t.klass.selectMonth).on("change",function(){var i=this.value;i&&(e.set("highlight",[e.get("view").year,i,e.get("highlight").date]),e.$root.find("."+t.klass.selectMonth).trigger("focus"))}),e.$root.find("."+t.klass.selectYear).on("change",function(){var i=this.value;i&&(e.set("highlight",[i,e.get("view").month,e.get("highlight").date]),e.$root.find("."+t.klass.selectYear).trigger("focus"))})},1).on("open",function(){var n="";i.disabled(i.get("now"))&&(n=":not(."+t.klass.buttonToday+")"),e.$root.find("button"+n+", select").attr("disabled",!1)},1).on("close",function(){e.$root.find("button, select").attr("disabled",!0)},1)}var n=7,s=6,a=e._;i.prototype.set=function(e,t,i){var n=this,s=n.item;return null===t?("clear"==e&&(e="select"),s[e]=t,n):(s["enable"==e?"disable":"flip"==e?"enable":e]=n.queue[e].split(" ").map(function(s){return t=n[s](e,t,i)}).pop(),"select"==e?n.set("highlight",s.select,i):"highlight"==e?n.set("view",s.highlight,i):e.match(/^(flip|min|max|disable|enable)$/)&&(s.select&&n.disabled(s.select)&&n.set("select",s.select,i),s.highlight&&n.disabled(s.highlight)&&n.set("highlight",s.highlight,i)),n)},i.prototype.get=function(e){return this.item[e]},i.prototype.create=function(e,i,n){var s,o=this;return i=void 0===i?e:i,i==-1/0||1/0==i?s=i:t.isPlainObject(i)&&a.isInteger(i.pick)?i=i.obj:t.isArray(i)?(i=new Date(Date.UTC(i[0],i[1],i[2])),i=a.isDate(i)?i:o.create().obj):i=a.isInteger(i)?o.normalize(new Date(i),n):a.isDate(i)?o.normalize(i,n):o.now(e,i,n),{year:s||i.getUTCFullYear(),month:s||i.getUTCMonth(),date:s||i.getUTCDate(),day:s||i.getUTCDay(),obj:s||i,pick:s||i.getTime()}},i.prototype.createRange=function(e,i){var n=this,s=function(e){return e===!0||t.isArray(e)||a.isDate(e)?n.create(e):e};return a.isInteger(e)||(e=s(e)),a.isInteger(i)||(i=s(i)),a.isInteger(e)&&t.isPlainObject(i)?e=[i.year,i.month,i.date+e]:a.isInteger(i)&&t.isPlainObject(e)&&(i=[e.year,e.month,e.date+i]),{from:s(e),to:s(i)}},i.prototype.withinRange=function(e,t){return e=this.createRange(e.from,e.to),t.pick>=e.from.pick&&t.pick<=e.to.pick},i.prototype.overlapRanges=function(e,t){var i=this;return e=i.createRange(e.from,e.to),t=i.createRange(t.from,t.to),i.withinRange(e,t.from)||i.withinRange(e,t.to)||i.withinRange(t,e.from)||i.withinRange(t,e.to)},i.prototype.now=function(e,t,i){return t=new Date,i&&i.rel&&t.setUTCDate(t.getUTCDate()+i.rel),this.normalize(t,i)},i.prototype.navigate=function(e,i,n){var s,a,o,r,l=t.isArray(i),c=t.isPlainObject(i),d=this.item.view;if(l||c){for(c?(a=i.year,o=i.month,r=i.date):(a=+i[0],o=+i[1],r=+i[2]),n&&n.nav&&d&&d.month!==o&&(a=d.year,o=d.month),s=new Date(Date.UTC(a,o+(n&&n.nav?n.nav:0),1)),a=s.getUTCFullYear(),o=s.getUTCMonth();new Date(Date.UTC(a,o,r)).getUTCMonth()!==o;)r-=1;i=[a,o,r]}return i},i.prototype.normalize=function(e){return e.setUTCHours(0,0,0,0),e},i.prototype.measure=function(e,t){var i=this;return t?"string"==typeof t?t=i.parse(e,t):a.isInteger(t)&&(t=i.now(e,t,{rel:t})):t="min"==e?-1/0:1/0,t},i.prototype.viewset=function(e,t){return this.create([t.year,t.month,1])},i.prototype.validate=function(e,i,n){var s,o,r,l,c=this,d=i,m=n&&n.interval?n.interval:1,u=-1===c.item.enable,h=c.item.min,f=c.item.max,p=u&&c.item.disable.filter(function(e){if(t.isArray(e)){var n=c.create(e).pick;n<i.pick?s=!0:n>i.pick&&(o=!0)}return a.isInteger(e)}).length;if((!n||!n.nav)&&(!u&&c.disabled(i)||u&&c.disabled(i)&&(p||s||o)||!u&&(i.pick<=h.pick||i.pick>=f.pick)))for(u&&!p&&(!o&&m>0||!s&&0>m)&&(m*=-1);c.disabled(i)&&(Math.abs(m)>1&&(i.month<d.month||i.month>d.month)&&(i=d,m=m>0?1:-1),i.pick<=h.pick?(r=!0,m=1,i=c.create([h.year,h.month,h.date+(i.pick===h.pick?0:-1)])):i.pick>=f.pick&&(l=!0,m=-1,i=c.create([f.year,f.month,f.date+(i.pick===f.pick?0:1)])),!r||!l);)i=c.create([i.year,i.month,i.date+m]);return i},i.prototype.disabled=function(e){var i=this,n=i.item.disable.filter(function(n){return a.isInteger(n)?e.day===(i.settings.firstDay?n:n-1)%7:t.isArray(n)||a.isDate(n)?e.pick===i.create(n).pick:t.isPlainObject(n)?i.withinRange(n,e):void 0});return n=n.length&&!n.filter(function(e){return t.isArray(e)&&"inverted"==e[3]||t.isPlainObject(e)&&e.inverted}).length,-1===i.item.enable?!n:n||e.pick<i.item.min.pick||e.pick>i.item.max.pick},i.prototype.parse=function(e,t,i){var n=this,s={};return t&&"string"==typeof t?(i&&i.format||(i=i||{},i.format=n.settings.format),n.formats.toArray(i.format).map(function(e){var i=n.formats[e],o=i?a.trigger(i,n,[t,s]):e.replace(/^!/,"").length;i&&(s[e]=t.substr(0,o)),t=t.substr(o)}),[s.yyyy||s.yy,+(s.mm||s.m)-1,s.dd||s.d]):t},i.prototype.formats=function(){function e(e,t,i){var n=e.match(/\w+/)[0];return i.mm||i.m||(i.m=t.indexOf(n)+1),n.length}function t(e){return e.match(/\w+/)[0].length}return{d:function(e,t){return e?a.digits(e):t.date},dd:function(e,t){return e?2:a.lead(t.date)},ddd:function(e,i){return e?t(e):this.settings.weekdaysShort[i.day]},dddd:function(e,i){return e?t(e):this.settings.weekdaysFull[i.day]},m:function(e,t){return e?a.digits(e):t.month+1},mm:function(e,t){return e?2:a.lead(t.month+1)},mmm:function(t,i){var n=this.settings.monthsShort;return t?e(t,n,i):n[i.month]},mmmm:function(t,i){var n=this.settings.monthsFull;return t?e(t,n,i):n[i.month]},yy:function(e,t){return e?2:(""+t.year).slice(2)},yyyy:function(e,t){return e?4:t.year},toArray:function(e){return e.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(e,t){var i=this;return i.formats.toArray(e).map(function(e){return a.trigger(i.formats[e],i,[0,t])||e.replace(/^!/,"")}).join("")}}}(),i.prototype.isDateExact=function(e,i){var n=this;return a.isInteger(e)&&a.isInteger(i)||"boolean"==typeof e&&"boolean"==typeof i?e===i:(a.isDate(e)||t.isArray(e))&&(a.isDate(i)||t.isArray(i))?n.create(e).pick===n.create(i).pick:t.isPlainObject(e)&&t.isPlainObject(i)?n.isDateExact(e.from,i.from)&&n.isDateExact(e.to,i.to):!1},i.prototype.isDateOverlap=function(e,i){var n=this,s=n.settings.firstDay?1:0;return a.isInteger(e)&&(a.isDate(i)||t.isArray(i))?(e=e%7+s,e===n.create(i).day+1):a.isInteger(i)&&(a.isDate(e)||t.isArray(e))?(i=i%7+s,i===n.create(e).day+1):t.isPlainObject(e)&&t.isPlainObject(i)?n.overlapRanges(e,i):!1},i.prototype.flipEnable=function(e){var t=this.item;t.enable=e||(-1==t.enable?1:-1)},i.prototype.deactivate=function(e,i){var n=this,s=n.item.disable.slice(0);return"flip"==i?n.flipEnable():i===!1?(n.flipEnable(1),s=[]):i===!0?(n.flipEnable(-1),s=[]):i.map(function(e){for(var i,o=0;o<s.length;o+=1)if(n.isDateExact(e,s[o])){i=!0;break}i||(a.isInteger(e)||a.isDate(e)||t.isArray(e)||t.isPlainObject(e)&&e.from&&e.to)&&s.push(e)}),s},i.prototype.activate=function(e,i){var n=this,s=n.item.disable,o=s.length;return"flip"==i?n.flipEnable():i===!0?(n.flipEnable(1),s=[]):i===!1?(n.flipEnable(-1),s=[]):i.map(function(e){var i,r,l,c;for(l=0;o>l;l+=1){if(r=s[l],n.isDateExact(r,e)){i=s[l]=null,c=!0;break}if(n.isDateOverlap(r,e)){t.isPlainObject(e)?(e.inverted=!0,i=e):t.isArray(e)?(i=e,i[3]||i.push("inverted")):a.isDate(e)&&(i=[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),"inverted"]);break}}if(i)for(l=0;o>l;l+=1)if(n.isDateExact(s[l],e)){s[l]=null;break}if(c)for(l=0;o>l;l+=1)if(n.isDateOverlap(s[l],e)){s[l]=null;break}i&&s.push(i)}),s.filter(function(e){return null!=e})},i.prototype.nodes=function(e){var t=this,i=t.settings,o=t.item,r=o.now,l=o.select,c=o.highlight,d=o.view,m=o.disable,u=o.min,h=o.max,f=function(e,t){return i.firstDay&&(e.push(e.shift()),t.push(t.shift())),a.node("thead",a.node("tr",a.group({min:0,max:n-1,i:1,node:"th",item:function(n){return[e[n],i.klass.weekdays,'scope=col title="'+t[n]+'"']}})))}((i.showWeekdaysFull?i.weekdaysFull:i.weekdaysShort).slice(0),i.weekdaysFull.slice(0)),p=function(e){return a.node("div"," ",i.klass["nav"+(e?"Next":"Prev")]+(e&&d.year>=h.year&&d.month>=h.month||!e&&d.year<=u.year&&d.month<=u.month?" "+i.klass.navDisabled:""),"data-nav="+(e||-1)+" "+a.ariaAttr({role:"button",components:t.$node[0].id+"_table"})+' title="'+(e?i.labelMonthNext:i.labelMonthPrev)+'"')},v=function(){var n=i.showMonthsShort?i.monthsShort:i.monthsFull;return i.selectMonths?a.node("select",a.group({min:0,max:11,i:1,node:"option",item:function(e){return[n[e],0,"value="+e+(d.month==e?" selected":"")+(d.year==u.year&&e<u.month||d.year==h.year&&e>h.month?" disabled":"")]}}),i.klass.selectMonth,(e?"":"disabled")+" "+a.ariaAttr({components:t.$node[0].id+"_table"})+' title="'+i.labelMonthSelect+'"'):a.node("div",n[d.month],i.klass.month)},g=function(){var n=d.year,s=i.selectYears===!0?5:~~(i.selectYears/2);if(s){var o=u.year,r=h.year,l=n-s,c=n+s;if(o>l&&(c+=o-l,l=o),c>r){var m=l-o,f=c-r;l-=m>f?f:m,c=r}return a.node("select",a.group({min:l,max:c,i:1,node:"option",item:function(e){return[e,0,"value="+e+(n==e?" selected":"")]}}),i.klass.selectYear,(e?"":"disabled")+" "+a.ariaAttr({components:t.$node[0].id+"_table"})+' title="'+i.labelYearSelect+'"')}return a.node("div",n,i.klass.year)};return a.node("div",(i.selectYears?g()+v():v()+g())+p()+p(1),i.klass.header)+a.node("table",f+a.node("tbody",a.group({min:0,max:s-1,i:1,node:"tr",item:function(e){var s=i.firstDay&&0===t.create([d.year,d.month,1]).day?-7:0;return[a.group({min:n*e-d.day+s+1,max:function(){return this.min+n-1},i:1,node:"td",item:function(e){e=t.create([d.year,d.month,e+(i.firstDay?1:0)]);var n=l&&l.pick==e.pick,s=c&&c.pick==e.pick,o=m&&t.disabled(e)||e.pick<u.pick||e.pick>h.pick;return[a.node("div",e.date,function(t){return t.push(d.month==e.month?i.klass.infocus:i.klass.outfocus),r.pick==e.pick&&t.push(i.klass.now),n&&t.push(i.klass.selected),s&&t.push(i.klass.highlighted),o&&t.push(i.klass.disabled),t.join(" ")}([i.klass.day]),"data-pick="+e.pick+" "+a.ariaAttr({role:"gridcell",selected:n&&t.$node.val()===a.trigger(t.formats.toString,t,[i.format,e])?!0:null,activedescendant:s?!0:null,disabled:o?!0:null})),"",a.ariaAttr({role:"presentation"})]}})]}})),i.klass.table,'id="'+t.$node[0].id+'_table" '+a.ariaAttr({role:"grid",components:t.$node[0].id,readonly:!0}))+a.node("div",a.node("button",i.today,i.klass.buttonToday,"type=button data-pick="+r.pick+(e&&!t.disabled(r)?"":" disabled")+" "+a.ariaAttr({components:t.$node[0].id}))+a.node("button",i.clear,i.klass.buttonClear,"type=button data-clear=1"+(e?"":" disabled")+" "+a.ariaAttr({components:t.$node[0].id}))+a.node("button",i.close,i.klass.buttonClose,"type=button data-close=true "+(e?"":" disabled")+" "+a.ariaAttr({components:t.$node[0].id})),i.klass.footer)},i.defaults=function(e){return{labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],today:"Today",clear:"Clear",close:"Close",format:"d mmmm, yyyy",klass:{table:e+"table",header:e+"header",navPrev:e+"nav--prev",navNext:e+"nav--next",navDisabled:e+"nav--disabled",month:e+"month",year:e+"year",selectMonth:e+"select--month",selectYear:e+"select--year",weekdays:e+"weekday",day:e+"day",disabled:e+"day--disabled",selected:e+"day--selected",highlighted:e+"day--highlighted",now:e+"day--today",infocus:e+"day--infocus",outfocus:e+"day--outfocus",footer:e+"footer",buttonClear:e+"button--clear",buttonToday:e+"button--today",buttonClose:e+"button--close"}}}(e.klasses().picker+"__"),e.extend("pickadate",i)}),function(e){e.fn.ContextualMenu=function(){return this.each(function(){var t=e(this);t.on("click",".ms-ContextualMenu-link:not(.is-disabled)",function(i){i.preventDefault(),t.hasClass("ms-ContextualMenu--multiselect")?e(this).hasClass("is-selected")?e(this).removeClass("is-selected"):e(this).addClass("is-selected"):(e(".ms-ContextualMenu-link").removeClass("is-selected").siblings(".ms-ContextualMenu").removeClass("is-open"),e(this).addClass("is-selected"),e(this).hasClass("ms-ContextualMenu-link--hasMenu")&&(e(this).siblings(".ms-ContextualMenu:first").addClass("is-open"),i.stopPropagation()))})})}}(jQuery),function(e){e.fn.Dialog=function(){return e(".js-DialogAction--open").each(function(){e(this).on("click",function(){var t=e(this).data("target");e(t).show()})}),this.each(function(){var t=this;e(t).hide(),e(t).find(".js-DialogAction--close").each(function(){e(this).on("click",function(){e(t).hide()})}),e(t).find(".ms-Dialog-action").on("click",function(){e(t).hide()})})}}(jQuery),function(e){e.fn.Dropdown=function(){return this.each(function(){function t(t){if(!i.hasClass("is-disabled")){i.find(".is-open").removeClass("is-open"),t.stopPropagation();var n=e(this).parents(".ms-Dropdown").width();e(this).next(".ms-Dropdown-items").css("width",n+"px"),i.toggleClass("is-open"),e(".ms-Dropdown").each(function(){e(this)[0]!==i[0]&&e(this).removeClass("is-open")}),e(document).bind("click.dropdown",function(){i.removeClass("is-open"),e(document).unbind("click.dropdown")})}}var i=e(this),n=i.children(".ms-Dropdown-select"),s=n.children("option"),a="",o="",r="";s.each(function(e,t){t.selected&&(a=t.text),o+='<li class="ms-Dropdown-item'+(t.disabled?' is-disabled"':'"')+">"+t.text+"</li>"}),r='<span class="ms-Dropdown-title">'+a+'</span><ul class="ms-Dropdown-items">'+o+"</ul>",i.append(r),i.on("click",".ms-Dropdown-title",function(e){t(e)}),i.on("keyup",function(s){var a=s.keyCode||s.which;if(e(this).hasClass("is-open")){if(e(this).hasClass("is-open")&&(38===a&&e(this).find(".ms-Dropdown-item.is-selected").prev().siblings().size()>0&&e(this).find(".ms-Dropdown-item.is-selected").removeClass("is-selected").prev().addClass("is-selected"),
40===a&&e(this).find(".ms-Dropdown-item.is-selected").next().siblings().size()>0&&e(this).find(".ms-Dropdown-item.is-selected").removeClass("is-selected").next().addClass("is-selected"),13===a&&!i.hasClass("is-disabled"))){var o=e(this).find(".ms-Dropdown-item.is-selected").text();e(this).find(".ms-Dropdown-title").html(o),n.find("option").each(function(t,i){i.text===o?e(this).prop("selected",!0):e(this).prop("selected",!1)}),n.change(),e(this).removeClass("is-open")}}else 13!==a&&38!==a&&40!==a||(t(s),e(this).find(".ms-Dropdown-item").hasClass("is-selected")||e(this).find(".ms-Dropdown-item:first").addClass("is-selected"));27===a&&e(this).removeClass("is-open")}),i.on("click",".ms-Dropdown-item",function(){if(!i.hasClass("is-disabled")&&!e(this).hasClass("is-disabled")){e(this).siblings(".ms-Dropdown-item").removeClass("is-selected"),e(this).addClass("is-selected"),e(this).parents().siblings(".ms-Dropdown-title").html(e(this).text());var t=e(this).text();n.find("option").each(function(i,n){n.text===t?e(this).prop("selected",!0):e(this).prop("selected",!1)}),n.change()}})})}}(jQuery),function(e){e.fn.Facepile=function(){return this.each(function(){e(".ms-PeoplePicker").PeoplePicker(),e(".ms-Panel").Panel();var t=e(this),i=e(".ms-Facepile-members"),n=e(".ms-Facepile-members > .ms-Facepile-itemBtn").length,s=e(".ms-Facepile-panel.ms-Panel"),a=s.find(".ms-Panel-main"),o=e(".ms-PeoplePicker.ms-PeoplePicker--Facepile"),r=o.find(".ms-PeoplePicker-selectedPeople"),l=e(".ms-Facepile").find(".ms-PersonaCard"),c=function(){if(n+=1,e(".ms-Facepile-members").children(":gt(4)").hide(),n>5){e(".ms-Facepile-itemBtn--overflow").addClass("is-active");var t=n-5;e(".ms-Facepile-overflowText").text("+"+t)}};t.on("click",".js-addPerson",function(){a.css({display:"block"}),s.toggleClass("is-open").addClass("ms-Panel-animateIn").removeClass("ms-Facepile-panel--overflow ms-Panel--right").addClass("ms-Facepile-panel--addPerson"),l.removeClass("is-active").hide()}),s.on("click",".js-togglePanel",function(){s.toggleClass("is-open").addClass("ms-Panel-animateIn")}),t.on("click",".js-overflowPanel",function(){a.css({display:"block"}),s.toggleClass("is-open").addClass("ms-Panel-animateIn").removeClass("ms-Facepile-panel--addPerson").addClass("ms-Facepile-panel--overflow ms-Panel--right")}),e(document).ready(function(){e(".ms-Facepile-overflowText").text("+"+n)}),e(".ms-PeoplePicker-result").on("click",function(){var t=e(this),n=t.find(".ms-Persona-primaryText").html(),s=t.find(".ms-Persona-secondaryText").html(),a=function(){for(var e=n.split(" "),t="",i=0;i<e.length;i++)t+=e[i].charAt(0);return t.substring(0,2)}(),o=t.find(".ms-Persona-initials").attr("class"),r=function(){if(t.find(".ms-Persona-image").length){var e=t.find(".ms-Persona-image").attr("src");return'<img class="ms-Persona-image" src="'+e+'" alt="Persona image">'}return""}(),l='<button class="ms-Facepile-itemBtn ms-Facepile-itemBtn--member" title="'+n+'"><div class="ms-Persona ms-Persona--xs"><div class="ms-Persona-imageArea"><div class="'+o+'">'+a+"</div>"+r+'</div><div class="ms-Persona-presence"></div><div class="ms-Persona-details"><div class="ms-Persona-primaryText">'+n+'</div><div class="ms-Persona-secondaryText">'+s+"</div></div></div></button>";i.prepend(l),c()}),r.on("click",".js-selectedRemove",function(){var t=e(this).parent().find(".ms-Persona-primaryText").text(),s=i.find(".ms-Persona-primaryText:contains("+t+")").first();if(s)if(s.parent().closest(".ms-Facepile-itemBtn").remove(),n-=1,e(".ms-Facepile-members").children(":lt(5)").show(),5>=n)e(".ms-Facepile-itemBtn--overflow").removeClass("is-active");else{var a=n-5;e(".ms-Facepile-overflowText").text("+"+a)}}),i.on("click",".ms-Facepile-itemBtn",function(){var t=e(this).find(".ms-Persona-primaryText").html(),i=e(this).find(".ms-Persona-secondaryText").html(),n=function(){for(var e=t.split(" "),i="",n=0;n<e.length;n++)i+=e[n].charAt(0);return i.substring(0,2)}(),s=e(this).find(".ms-Persona-initials").attr("class"),a=e(this).find(".ms-Persona-image").attr("src"),o=e(".ms-PersonaCard"),r=o.find(".ms-Persona-primaryText"),c=o.find(".ms-Persona-secondaryText"),d=o.find(".ms-Persona-initials"),m=o.find(".ms-Persona-image");if(l.removeClass("is-active"),r.text(t),c.text(i),d.text(n),d.removeClass(),d.addClass(s),m.attr("src",a),setTimeout(function(){l.addClass("is-active")},100),e(window).width()>480){var u=e(this).offset().left,h=u-26;l.css({left:h})}else l.css({left:0,top:"auto",position:"fixed"})}),e(document).on("click",function(t){var i=e(".ms-Facepile-itemBtn--member");i.is(t.target)||0!==i.has(t.target).length||l.is(t.target)||0!==l.has(t.target).length?l.addClass("is-active"):(l.removeClass("is-active"),l.removeAttr("style"))})})}}(jQuery),function(e){e.fn.ListItem=function(){return this.each(function(){var t=e(this);t.on("click",".js-toggleSelection",function(){e(this).parents(".ms-ListItem").toggleClass("is-selected")})})}}(jQuery);var fabric=fabric||{};fabric.MessageBanner=function(e){this.container=e,this.init()},fabric.MessageBanner.prototype=function(){var e,t,i,n,s,a,o,r,l,c=700,d=88,m=35,u=480,h=function(){i=o.offsetWidth,window.innerWidth>=u?f():p()},f=function(){i-t>s&&c>s?(n="auto",a.className="ms-MessageBanner-expand",k()):(n=Math.min(i-t,c)+"px",-1===a.className.indexOf("is-visible")&&(a.className+=" is-visible")),e.style.width=n},p=function(){i-(m+l.offsetWidth)>s?(n="auto",k()):n=i-(m+l.offsetWidth)+"px",e.style.width=n},v=function(i){o=i.container,e=i.container.querySelector(".ms-MessageBanner-clipper"),a=i.container.querySelector(".ms-MessageBanner-expand"),r=i.container.querySelector(".ms-MessageBanner-action"),t=r.offsetWidth+d,l=i.container.querySelector(".ms-MessageBanner-close")},g=function(){var e=a.querySelector(".ms-Icon");o.className+=" is-expanded",e.className="ms-Icon ms-Icon--chevronsUp"},k=function(){var e=a.querySelector(".ms-Icon");o.className="ms-MessageBanner",e.className="ms-Icon ms-Icon--chevronsDown"},P=function(){o.className.indexOf("is-expanded")>-1?k():g()},y=function(){-1===o.className.indexOf("hide")&&(o.className+=" hide",setTimeout(function(){o.className="ms-MessageBanner is-hidden"},500))},C=function(){o.className="ms-MessageBanner"},b=function(){window.addEventListener("resize",h,!1),a.addEventListener("click",P,!1),l.addEventListener("click",y,!1)},x=function(){v(this),b(),i=o.offsetWidth,s=e.offsetWidth,h(null)};return{init:x,showBanner:C}}(),function(e){e.fn.NavBar=function(){return this.each(function(){var t=e(this);t.on("click",".js-openMenu",function(e){e.stopPropagation(),t.toggleClass("is-open")}),t.click(function(){t.hasClass("is-open")&&t.removeClass("is-open")}),t.on("click",".ms-NavBar-item:not(.is-disabled)",function(i){var n=t.find(".ms-NavBar-item.ms-NavBar-item--search .ms-TextField-field");i.stopPropagation(),0===e(this).children(".ms-NavBar-link").length&&i.preventDefault(),e(this).siblings(".ms-NavBar-item").removeClass("is-selected"),n.length>0&&0===n.val().length&&e(".ms-NavBar-item.ms-NavBar-item--search").removeClass("is-open").find(".ms-TextField-field").blur(),e(this).hasClass("ms-NavBar-item--hasMenu")?(e(this).siblings(".ms-NavBar-item--hasMenu").children(".ms-ContextualMenu:first").removeClass("is-open"),e(this).children(".ms-ContextualMenu:first").toggleClass("is-open"),e(this).toggleClass("is-selected")):(e(this).addClass("is-selected"),t.removeClass("is-open").find(".ms-ContextualMenu").removeClass("is-open")),e(this).hasClass("ms-NavBar-item--search")&&(e(this).addClass("is-open"),e(this).find(".ms-TextField-field").focus(),t.find(".ms-ContextualMenu:first").removeClass("is-open"))}),t.on("click",".ms-NavBar-item .ms-ContextualMenu",function(i){i.stopPropagation(),e(this).removeClass("is-open"),t.removeClass("is-open").find(".ms-NavBar-item--hasMenu").removeClass("is-selected")}),e(document).on("click","html",function(){var e=t.find(".ms-NavBar-item.ms-NavBar-item--search .ms-TextField-field");t.find(".ms-NavBar-item").removeClass("is-selected").find(".ms-ContextualMenu").removeClass("is-open"),e.length>0&&0===e.val().length&&t.find(".ms-NavBar-item.ms-NavBar-item--search").removeClass("is-open").find(".ms-TextField-field").blur()})})}}(jQuery),function(e){e.fn.Panel=function(){function t(e,t,n){for(var s=0;s<i.length;s++)i[s]||(t=t.toLowerCase()),e.addEventListener(i[s]+t,n,!1)}var i=["webkit","moz","MS","o",""];return this.each(function(){var i=e(this),n=i.find(".ms-Panel-main");e(".ms-PanelAction-close").on("click",function(){i.addClass("ms-Panel-animateOut")}),e(".ms-PanelAction-open").on("click",function(){i.addClass("is-open"),i.addClass("ms-Panel-animateIn")}),t(n[0],"AnimationEnd",function(e){e.animationName.indexOf("Out")>-1&&(i.removeClass("is-open"),i.removeClass("ms-Panel-animateIn ms-Panel-animateOut"))}),e(".panelVariant-item").on("click",function(){var t=e(this).find("span").attr("class");switch(e(".panelVariant-item").removeClass("is-selected"),e(this).addClass("is-selected"),t){case"is-default":e(".ms-Panel").removeClass().addClass("ms-Panel");break;case"is-left":e(".ms-Panel").removeClass().addClass("ms-Panel ms-Panel--left");break;case"is-lightDismiss":e(".ms-Panel").removeClass().addClass("ms-Panel ms-Panel--lightDismiss");break;case"is-md":e(".ms-Panel").removeClass().addClass("ms-Panel ms-Panel--md");break;case"is-lgFixed":e(".ms-Panel").removeClass().addClass("ms-Panel ms-Panel--lg ms-Panel--fixed");break;case"is-lg":e(".ms-Panel").removeClass().addClass("ms-Panel ms-Panel--lg");break;case"is-xl":e(".ms-Panel").removeClass().addClass("ms-Panel ms-Panel--xl")}})})}}(jQuery);var fabric=fabric||{};!function(e){function t(e){var t=e.find(".ms-PeoplePicker-searchBox"),i=t.position().left,n=t.outerWidth(),s=i+n,a=t.find(".ms-PeoplePicker-persona:last"),o=a.offset().left,r=a.outerWidth(),l=o+r,c=s-l-7;100>c&&(c="100%"),e.find(".ms-PeoplePicker-searchField").outerWidth(c)}e.fn.PeoplePicker=function(){return this.each(function(){function i(t){e("html, body").animate({scrollTop:s.offset().top},367),s.hasClass("is-active")&&s.removeClass("is-active"),s.hasClass("ms-PeoplePicker--Facepile")&&""===a.val()&&d.children(":gt(4)").hide(),s.hasClass("ms-PeoplePicker--Facepile")&&(l.addClass("ms-u-slideDownIn20"),setTimeout(function(){o.removeClass("ms-u-slideDownIn20"),l.removeClass("ms-u-slideDownIn20")},1e3)),m=!0,t.stopPropagation(),s.hasClass("ms-PeoplePicker--Facepile")||o.width(s.width()-2),s.addClass("is-active"),e(document).bind("click.peoplepicker",function(){s.removeClass("is-active"),s.hasClass("ms-PeoplePicker--Facepile")&&(s.removeClass("is-searching"),e(".ms-PeoplePicker-selected").show(),e(".ms-PeoplePicker-searchMore").removeClass("is-active"),a.val("")),e(document).unbind("click.peoplepicker"),m=!1})}var n,s=e(this),a=s.find(".ms-PeoplePicker-searchField"),o=s.find(".ms-PeoplePicker-results"),r=s.find(".ms-PeoplePicker-selected"),l=s.find(".ms-PeoplePicker-selectedPeople"),c=s.find(".ms-PeoplePicker-selectedCount"),d=s.find(".ms-PeoplePicker-peopleList"),m=!1,u=e(".ms-PeoplePicker").find(".ms-PersonaCard");s.on("focus",".ms-PeoplePicker-searchField",function(e){i(e)}),s.on("click",".ms-PeoplePicker-searchField",function(e){i(e)}),e(this).click(function(e){e.stopPropagation()}),o.on("click",".ms-PeoplePicker-result",function(){var i=e(this),n=i.find(".ms-Persona-primaryText").html(),o=i.find(".ms-Persona-secondaryText").html(),m=function(){for(var e=n.split(" "),t="",i=0;i<e.length;i++)t+=e[i].charAt(0);return t.substring(0,2)}(),u=i.find(".ms-Persona-initials").attr("class"),h=function(){if(i.find(".ms-Persona-image").length){var e=i.find(".ms-Persona-image").attr("src");return'<img class="ms-Persona-image" src="'+e+'" alt="Persona image">'}return""}(),f='<div class="ms-PeoplePicker-persona"><div class="ms-Persona ms-Persona--xs ms-Persona--square"><div class="ms-Persona-imageArea"><div class="'+u+'">'+m+"</div>"+h+'</div><div class="ms-Persona-presence"></div><div class="ms-Persona-details"><div class="ms-Persona-primaryText">'+n+'</div> </div></div><button class="ms-PeoplePicker-personaRemove"><i class="ms-Icon ms-Icon--x"></i> </button></div>',p='<li class="ms-PeoplePicker-selectedPerson"><div class="ms-Persona ms-Persona--sm"><div class="ms-Persona-imageArea"><div class="'+u+'">'+m+"</div>"+h+'</div><div class="ms-Persona-presence"></div><div class="ms-Persona-details"><div class="ms-Persona-primaryText">'+n+'</div><div class="ms-Persona-secondaryText">'+o+'</div></div></div><button class="ms-PeoplePicker-resultAction js-selectedRemove"><i class="ms-Icon ms-Icon--x"></i></button></li>';if(s.hasClass("ms-PeoplePicker--Facepile")||s.hasClass("ms-PeoplePicker--membersList")){r.hasClass("is-active")||r.addClass("is-active"),l.prepend(p),s.removeClass("is-active");var v=s.find(".ms-PeoplePicker-selectedPerson").length;c.html(v),d.children().show(),d.children(":gt(4)").hide(),e(".ms-PeoplePicker-searchMore").removeClass("is-active"),a.val("")}else a.before(f),s.removeClass("is-active"),t(s)}),s.on("click",".ms-PeoplePicker-personaRemove",function(){e(this).parents(".ms-PeoplePicker-persona").remove(),0===e(".ms-PeoplePicker-persona").length?s.find(".ms-PeoplePicker-searchField").outerWidth("100%"):t(s)}),o.on("click",".js-searchMore",function(){var t=e(this),i=t.find(".ms-PeoplePicker-searchMorePrimary"),o=i.html(),r=a.val();t.addClass("is-searching"),i.html("Searching for "+r),n?n.start():n=new fabric.Spinner(t.get(0)),s.hasClass("ms-PeoplePicker--Facepile")&&setTimeout(function(){d.children().show()},1500),setTimeout(function(){t.removeClass("is-searching"),i.html(o),n.stop()},1500)}),o.on("click",".js-resultRemove",function(t){t.stopPropagation(),e(this).parent(".ms-PeoplePicker-result").remove()}),o.on("click",".js-resultExpand",function(t){t.stopPropagation(),e(this).parent(".ms-PeoplePicker-result").toggleClass("is-expanded")}),l.on("click",".js-selectedRemove",function(t){t.stopPropagation(),e(this).parent(".ms-PeoplePicker-selectedPerson").remove();var i=s.find(".ms-PeoplePicker-selectedPerson").length;c.html(i),0===s.find(".ms-PeoplePicker-selectedPerson").length&&r.removeClass("is-active")});var h=function(t,i,n){return t.find(".ms-Persona-primaryText").filter(function(){return n?e(this).text().toLowerCase()===i:e(this).text().toLowerCase()!==i}).parents(".ms-PeoplePicker-peopleListItem")};s.on("keyup",".ms-PeoplePicker-searchField",function(t){var i=[],n=[],a=o.find(".ms-Persona-primaryText");s.addClass("is-searching"),r.hide(),d.children(":lt(5)").show(),e(".ms-PeoplePicker-searchMore").addClass("is-active"),a.each(function(){i.push(e(this).text())});for(var c=0;c<i.length;c++){var m,u=i[c].toLowerCase(),f=t.target.value.toLowerCase();u.indexOf(f)>-1?(m=i[c].toLowerCase(),n.push(i[c]),h(o,m,!0).show()):h(o,m,!1).hide()}""===e(this).val()&&(s.removeClass("is-searching"),r.show(),e(".ms-PeoplePicker-searchMore").removeClass("is-active"),l.addClass("ms-u-slideDownIn20"),setTimeout(function(){l.removeClass("ms-u-slideDownIn20")},1e3),d.children(":gt(4)").hide())}),l.on("click",".ms-Persona",function(){var t=e(this).find(".ms-Persona-primaryText").html(),i=e(this).find(".ms-Persona-secondaryText").html(),n=function(){for(var e=t.split(" "),i="",n=0;n<e.length;n++)i+=e[n].charAt(0);return i.substring(0,2)}(),s=e(this).find(".ms-Persona-initials").attr("class"),a=e(this).find(".ms-Persona-image").attr("src"),o=e(".ms-PersonaCard"),r=o.find(".ms-Persona-primaryText"),l=o.find(".ms-Persona-secondaryText"),c=o.find(".ms-Persona-initials"),d=o.find(".ms-Persona-image");if(u.removeClass("is-active"),r.text(t),l.text(i),c.text(n),c.removeClass(),c.addClass(s),d.attr("src",a),setTimeout(function(){u.addClass("is-active"),setTimeout(function(){u.css({"animation-name":"none"})},300)},100),e(window).width()>480){var m=e(this).offset().top,h=m+10;u.css({top:h,left:0})}else u.css({top:"auto"})}),e(document).on("click",function(t){var i=e(".ms-PeoplePicker-selectedPerson").find(".ms-Persona");i.is(t.target)||u.is(t.target)||0!==u.has(t.target).length?u.addClass("is-active"):(u.removeClass("is-active"),setTimeout(function(){u.removeAttr("style")},300))})})}}(jQuery),function(e){e.fn.PersonaCard=function(){return this.each(function(){var t=e(this);t.on("click",".ms-PersonaCard-action",function(){t.find(".ms-PersonaCard-action").removeClass("is-active"),e(this).addClass("is-active");var i=function(e,t){var i=e.className+"",n=t.charAt(0).toUpperCase()+t.slice(1),s="ms-PersonaCard-detail"+n;i!==s&&(e.classList.remove(i),e.classList.add(s))},n=e(this).attr("id");i(e(this).parent().next().find("#detailList")[0],n);var s=e(this).attr("id");t.find(".ms-PersonaCard-actionDetails").removeClass("is-active"),t.find("#"+s+".ms-PersonaCard-actionDetails").addClass("is-active")}),t.on("click",".ms-PersonaCard-detailExpander",function(){e(this).parent(".ms-PersonaCard-actionDetails").toggleClass("is-collapsed")})})}}(jQuery),function(e){e.fn.Pivot=function(){return this.each(function(){var t=e(this);t.on("click",".ms-Pivot-link",function(t){t.preventDefault();var i=e(this).find(".ms-Pivot-ellipsis");0===i.length&&(e(this).siblings(".ms-Pivot-link").removeClass("is-selected"),e(this).addClass("is-selected"))})})}}(jQuery);var fabric=fabric||{};fabric.ProgressIndicator=function(e){this.container=e,this.cacheDOM()},fabric.ProgressIndicator.prototype=function(){var e,t,i,n,s,a,o=function(e){a.style.width=Math.round(t*e)+"px"},r=function(t){e=t;var i=e/n;this.setProgressPercent(i)},l=function(e){n=e},c=function(e){i.innerHTML=e},d=function(e){s.innerHTML=e},m=function(){i=this.container.querySelector(".ms-ProgressIndicator-itemName")||null,s=this.container.querySelector(".ms-ProgressIndicator-itemDescription")||null,a=this.container.querySelector(".ms-ProgressIndicator-progressBar"),t=this.container.querySelector(".ms-ProgressIndicator-itemProgress").offsetWidth};return{setProgressPercent:o,setName:c,setDescription:d,setProgress:r,setTotal:l,cacheDOM:m}}(),function(e){e.fn.SearchBox=function(){return this.each(function(){var t=!1,i=e(this).find(".ms-SearchBox-field");i.on("focus",function(){e(this).siblings(".ms-SearchBox-label").hide(),e(this).parent(".ms-SearchBox").addClass("is-active")}),i.on("mouseover",function(){i.addClass("hovering")}),i.on("mouseout",function(){i.removeClass("hovering")}),e(this).find(".ms-SearchBox-closeButton").on("mousedown",function(){t=!0}),e(this).find(".ms-SearchBox-field").on("blur",function(){t&&(e(this).val(""),i.addClass("hovering"));var n=e(this).parent(".ms-SearchBox");setTimeout(function(){n.removeClass("is-active")},10),0===e(this).val().length&&e(this).siblings(".ms-SearchBox-label").show(),t=!1})})}}(jQuery);var fabric=fabric||{};fabric.Spinner=function(e){function t(){i(),u=setInterval(function(){for(var e=k.length;e--;)a(k[e])},P)}function i(){clearInterval(u)}function n(){m(),d(),c(),s(),t()}function s(){var e,t=0,i=1;for(y=1/f,t;f>t;t++){var n=k[t];e=y*i++,r(n.element,e)}}function a(e){var t=o(e.element)-y;0>=t&&(t=1),r(e.element,t)}function o(e){return parseFloat(window.getComputedStyle(e).getPropertyValue("opacity"))}function r(e,t){e.style.opacity=t}function l(){var e=document.createElement("div");return e.className="ms-Spinner-circle",e.style.width=e.style.height=C*p+"px",e}function c(){for(var e,t=0,i=C*p,n=2*Math.PI/f,s=f,a=.5*(C-i);s--;){var o=l(),r=Math.round(.5*C+a*Math.cos(t)-.5*o.clientWidth)-.5*i,c=Math.round(.5*C+a*Math.sin(t)-.5*o.clientHeight)-.5*i;h.appendChild(o),o.style.left=r+"px",o.style.top=c+"px",t+=n,e={element:o,j:s},k.push(e)}}function d(){h.className.indexOf("large")>-1&&(C=28,g=.179),p=g,f=8}function m(){-1===v.className.indexOf("ms-Spinner")?(h=document.createElement("div"),h.className="ms-Spinner",v.appendChild(h)):h=v}var u,h,f,p,v=e,g=.2,k=[],P=90,y=0,C=20;return n(),{start:t,stop:i}},function(e){e.fn.TextField=function(){return this.each(function(){e(this).hasClass("ms-TextField--placeholder")&&(e(this).on("click",function(){e(this).find(".ms-Label").hide()}),e(this).find(".ms-TextField-field").on("focus",function(){e(this).siblings(".ms-Label").hide()}),e(this).find(".ms-TextField-field").on("blur",function(){0===e(this).val().length&&e(this).siblings(".ms-Label").show()})),e(this).hasClass("ms-TextField--underlined")&&(e(this).find(".ms-TextField-field").on("focus",function(){e(this).parent(".ms-TextField--underlined").addClass("is-active")}),e(this).find(".ms-TextField-field").on("blur",function(){e(this).parent(".ms-TextField--underlined").removeClass("is-active")}))})}}(jQuery);